import{a as Q,u as P,r as o,b as N,c as f,j as e,d as n,A as W}from"./index-BvbRJS_t.js";import{M as O,a as L,b as R}from"./index-DWuUjxJc.js";import{R as U}from"./index-DEuL2NM2.js";import{B as m}from"./BuyerBottomNav-Bxt6vIKH.js";import{T as M}from"./TopTabBar-BreSykwf.js";/* empty css                       */const H=()=>{const{buyerToken:g}=Q(),x=P(),[b,j]=o.useState(!0),[w,y]=o.useState([]),[a,v]=o.useState(null),[i,c]=o.useState(0),[q,h]=o.useState(!1),[p,C]=o.useState(null),[t,r]=o.useState({color:"",location:"",height:"",width:"",quantity:"",remarks:""});o.useEffect(()=>{k()},[]);const k=async()=>{try{j(!0);const l=(await N.get(f("api/options"))).data.map(d=>({id:d._id,name:d.title.toUpperCase(),count:d.subOptions.length,designs:d.subOptions.map(u=>({id:u._id,title:u.title,video:u.videoUrl,features:u.features||[]}))}));y(l)}catch(s){C(s.message),console.error("Error fetching window designs:",s)}finally{j(!1)}},B=()=>{x("/buyer/notifications")},S=s=>{a&&a.id===s.id?(v(null),c(0)):(v(s),c(0))},D=()=>{a&&i<a.designs.length-1&&c(i+1)},I=()=>{i>0&&c(i-1)},E=()=>{if(!g){alert("Please login to add quotes"),x("/buyer/login");return}if(!a){alert("Please select a window design first");return}h(!0)},A=async()=>{if(!t.color||!t.location||!t.height||!t.width||!t.quantity){alert("Please fill in all required fields");return}try{const s=a.designs[i];await N.post(f("api/quotes"),{designId:s.id,designTitle:s.title,categoryName:a.name,...t},{headers:{Authorization:`Bearer ${g}`}}),alert("Quote added successfully!"),h(!1),r({color:"",location:"",height:"",width:"",quantity:"",remarks:""})}catch(s){console.error("Error adding quote:",s),alert("Failed to add quote. Please try again.")}},T=s=>{if(!s)return null;if(/^https?:\/\//i.test(s))return s;const l=s.startsWith("/")?s:`/${s}`;return`${W}${l}`};return b?e.jsxs("div",{className:"buyer-dashboard-container",children:[e.jsx("div",{className:"loading-container",children:e.jsx("div",{className:"spinner"})}),e.jsx(m,{})]}):p?e.jsxs("div",{className:"buyer-dashboard-container",children:[e.jsx("div",{className:"error-container",children:e.jsxs(n,{className:"error-text",children:["Error: ",p]})}),e.jsx(m,{})]}):e.jsxs("div",{className:"buyer-dashboard-container",children:[e.jsxs("div",{className:"buyer-dashboard-header",children:[e.jsx("div",{className:"header-spacer"}),e.jsx("img",{src:"/logo.png",alt:"Logo",className:"dashboard-logo"}),e.jsx("button",{className:"notification-button",onClick:B,"aria-label":"Notifications",children:e.jsx(O,{size:24,color:"#000"})})]}),e.jsx(M,{}),e.jsxs("div",{className:"buyer-dashboard-content buy-now-content",children:[e.jsxs("div",{className:"buy-now-header",children:[e.jsx(n,{weight:"Inter",className:"buy-now-title",children:"SELECT WINDOW DESIGN"}),e.jsx(n,{weight:"Inter",className:"buy-now-subtitle",children:"Choose from our premium window designs and request a quote"})]}),e.jsx("div",{className:"window-designs-list",children:w.map(s=>e.jsxs("div",{className:"design-category",children:[e.jsxs("button",{className:`category-header ${a?.id===s.id?"active":""}`,onClick:()=>S(s),children:[e.jsxs("div",{className:"category-info",children:[e.jsx(n,{weight:"Inter",className:"category-name",children:s.name}),e.jsxs(n,{weight:"Inter",className:"category-count",children:[s.count," Designs"]})]}),e.jsx("span",{className:"expand-icon",children:a?.id===s.id?"−":"+"})]}),a?.id===s.id&&e.jsxs("div",{className:"designs-container",children:[e.jsxs("div",{className:"design-navigation",children:[e.jsx("button",{className:"nav-button",onClick:I,disabled:i===0,children:e.jsx(L,{size:24})}),e.jsxs(n,{weight:"Inter",className:"design-counter",children:[i+1," / ",a.designs.length]}),e.jsx("button",{className:"nav-button",onClick:D,disabled:i===a.designs.length-1,children:e.jsx(R,{size:24})})]}),a.designs[i]&&e.jsxs("div",{className:"design-card",children:[e.jsx(n,{weight:"Inter",className:"design-title",children:a.designs[i].title}),a.designs[i].video&&e.jsx("div",{className:"design-video-container",children:e.jsx(U,{url:T(a.designs[i].video),controls:!0,playing:!1,width:"100%",height:"100%",onError:l=>{console.error("Video failed to load:",l)}})}),a.designs[i].features?.length>0&&e.jsxs("div",{className:"design-features",children:[e.jsx(n,{weight:"Inter",className:"features-title",children:"Features:"}),e.jsx("ul",{className:"features-list",children:a.designs[i].features.map((l,d)=>e.jsx("li",{children:e.jsx(n,{weight:"Inter",className:"feature-text",children:l})},d))})]}),e.jsx("button",{className:"add-quote-button",onClick:E,children:e.jsx(n,{weight:"Inter",className:"add-quote-text",children:"ADD TO QUOTE"})})]})]})]},s.id))})]}),q&&e.jsx("div",{className:"quote-modal-overlay",onClick:()=>h(!1),children:e.jsxs("div",{className:"quote-modal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"quote-modal-header",children:[e.jsx(n,{weight:"Inter",className:"quote-modal-title",children:"Request Quote"}),e.jsx("button",{className:"close-button",onClick:()=>h(!1),children:"×"})]}),e.jsxs("div",{className:"quote-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Color *"}),e.jsxs("select",{value:t.color,onChange:s=>r({...t,color:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Color"}),e.jsx("option",{value:"White",children:"White"}),e.jsx("option",{value:"Black",children:"Black"}),e.jsx("option",{value:"Wooden Brown",children:"Wooden Brown"}),e.jsx("option",{value:"Silver Grey",children:"Silver Grey"}),e.jsx("option",{value:"Golden Oak",children:"Golden Oak"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Location *"}),e.jsxs("select",{value:t.location,onChange:s=>r({...t,location:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Location"}),e.jsx("option",{value:"Balcony",children:"Balcony"}),e.jsx("option",{value:"Living Room",children:"Living Room"}),e.jsx("option",{value:"Bedroom",children:"Bedroom"}),e.jsx("option",{value:"Kitchen",children:"Kitchen"}),e.jsx("option",{value:"Bathroom",children:"Bathroom"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Height (ft) *"}),e.jsx("input",{type:"number",value:t.height,onChange:s=>r({...t,height:s.target.value}),placeholder:"e.g. 5"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Width (ft) *"}),e.jsx("input",{type:"number",value:t.width,onChange:s=>r({...t,width:s.target.value}),placeholder:"e.g. 4"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Quantity *"}),e.jsx("input",{type:"number",value:t.quantity,onChange:s=>r({...t,quantity:s.target.value}),placeholder:"e.g. 2"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Remarks"}),e.jsx("textarea",{value:t.remarks,onChange:s=>r({...t,remarks:s.target.value}),placeholder:"Any additional information...",rows:"3"})]}),e.jsx("button",{className:"submit-quote-button",onClick:A,children:e.jsx(n,{weight:"Inter",className:"submit-quote-text",children:"SUBMIT QUOTE"})})]})]})}),e.jsx(m,{})]})};export{H as default};
